(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{21:function(e,t,n){},28:function(e,t,n){},38:function(e,t,n){},47:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),r=n(16),a=n.n(r),s=(n(38),n(3)),i=Object(c.createContext)({token:null,userId:null,login:function(){},logout:function(){},isAuth:!1}),u=n(11),l=n(10),j=n(1),b=function(e){var t,n,o="/img/"+e.pokemon.id+".png";e.pokemon.id>=721&&(o="/img/"+(t=1,n=720,t=Math.ceil(t),n=Math.floor(n),Math.floor(Math.random()*(n-t))+t)+".png");var r=Object(c.useState)(!1),a=Object(u.a)(r,2),s=(a[0],a[1]);return Object(j.jsxs)("div",{className:"pokemons__card",children:[Object(j.jsxs)(l.b,{to:"/pokemon/:".concat(e.pokemon.id),children:[Object(j.jsx)("img",{src:o,alt:"pokemon"}),Object(j.jsx)("h5",{children:e.pokemon.name})]}),Object(j.jsx)("button",{className:"pokemons__card__btn",disabled:e.pokemon.disabled,onClick:function(){s(!0),e.pokemon.disabled=!0,e.catchPokemon(e.pokemon)},children:"\u041f\u043e\u0439\u043c\u0430\u0442\u044c \u043f\u043e\u043a\u0435\u043c\u043e\u043d\u0430"})]})},d=function(e){return e.pokemons.map((function(t){return Object(j.jsx)(b,{pokemon:t,catchPokemon:e.catchPokemon},t.id)}))},p=(n(28),function(){return Object(j.jsx)("div",{className:"container__loader",children:Object(j.jsx)("div",{className:"loader"})})}),O=(n(21),n(47),n(4)),h=n(6),m=n.n(h),f=n(12),x="GET_POKEMONS",k="GET_POKEMON",g="CAUGHT_POKEMON",v="LOAD_MORE",_="NOT_AUTH",y="SHOW_LOADER",N="HIDE_LOADER",C="RESET_POKEMON";function P(){return{type:y}}function E(){return{type:N}}var w=n(17),S=n(2),I=(n(53),function(){var e=Object(c.useContext)(i),t=Object(c.useCallback)((function(e){e&&alert(e)}),[]),n=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)(null),a=Object(u.a)(r,2),s=a[0],i=a[1];return{loading:n,request:Object(c.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t){var n,c,r,a,s,u=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",c=u.length>2&&void 0!==u[2]?u[2]:"null",r=u.length>3&&void 0!==u[3]?u[3]:{},o(!0),c&&(c=JSON.stringify(c),r["Content-Type"]="application/json"),e.prev=5,e.next=8,fetch(t,{method:n,body:c,headers:r});case 8:return a=e.sent,e.next=11,a.json();case 11:if(s=e.sent,a.ok){e.next=14;break}throw new Error(s.message||"Error!");case 14:return o(!1),e.abrupt("return",s);case 18:throw e.prev=18,e.t0=e.catch(5),o(!1),i(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:s,clearError:Object(c.useCallback)((function(){return i(null)}),[])}}(),o=n.loading,r=n.request,a=n.error,s=n.clearError,l=Object(O.b)(),b=Object(c.useState)({login:"",password:""}),d=Object(u.a)(b,2),p=d[0],h=d[1];Object(c.useEffect)((function(){t(a),s()}),[a,t,s]);var x=function(e){h(Object(S.a)(Object(S.a)({},p),{},Object(w.a)({},e.target.name,e.target.value)))},k=function(){var t=Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.logout(),l({type:C}),t.prev=2,t.next=5,r("/api/auth/login","POST",Object(S.a)({},p));case 5:n=t.sent,e.login(n.token,n.userId),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(){return t.apply(this,arguments)}}(),g=function(){var e=Object(f.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("/api/auth/register","POST",Object(S.a)({},p));case 3:n=e.sent,t(n.message),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("e =",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(j.jsx)("div",{className:"first",children:Object(j.jsxs)("div",{className:"first__auth",children:[Object(j.jsxs)("div",{className:"first__auth__input",children:[Object(j.jsx)("input",{className:"input",type:"text",id:"login",name:"login",onChange:x,placeholder:"Login"}),Object(j.jsx)("input",{id:"password",className:"input",name:"password",type:"text",onChange:x,placeholder:"Password"})]}),Object(j.jsxs)("div",{className:"first__auth__operations",children:[Object(j.jsx)("button",{className:"first__auth__operations_login",onClick:k,disabled:o,children:"\u0412\u043e\u0439\u0442\u0438"}),Object(j.jsx)("button",{className:"first__auth__operations_register",onClick:g,disabled:o,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})]})})}),T=function(){var e=Object(O.b)(),t=Object(c.useContext)(i).token,n=Object(O.c)((function(e){return e.pokemons.pokemons})),o=Object(O.c)((function(e){return e.pokemons.displayPokemons})),r=Object(O.c)((function(e){return e.load.loading})),a=Object(O.c)((function(e){return e.load.notAuth})),s=Object(c.useCallback)((function(){e({type:v})}),[e]),u=Object(c.useCallback)((function(n){e(function(e,t){return function(){var n=Object(f.a)(m.a.mark((function n(c){var o;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.disabled=!0,e.pokemonId=e.id,n.next=5,fetch("/api/img/catch",{method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t)}});case 5:return o=n.sent,n.next=8,o.json();case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),console.log("err",n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(n,t))}),[e,t]);return Object(c.useEffect)((function(){n.length||e(function(e){return function(){var t=Object(f.a)(m.a.mark((function t(n){var c,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(P()),t.next=4,fetch("/api/img/all",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});case 4:return c=t.sent,t.next=7,c.json();case 7:(o=t.sent).message?n({type:_}):n({type:x,payload:o}),n(E()),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log("err",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(t))}),[e,t,n.length]),r?Object(j.jsx)(p,{}):a?Object(j.jsx)(I,{}):Object(j.jsx)(j.Fragment,{children:!r&&Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)("div",{className:"pokemons",children:Object(j.jsx)(d,{pokemons:o,enableCatchBtn:!0,catchPokemon:u})}),Object(j.jsx)("button",{className:"loadMore",onClick:s,children:"Load more"})]})})},A=function(e){return Object(j.jsx)("div",{className:"pokemons__card",children:Object(j.jsxs)(l.b,{to:"/pokemon/:".concat(e.pokemon.pokemonId),children:[Object(j.jsx)("img",{src:"/img/"+e.pokemon.pokemonId+".png",alt:"pokemon"}),Object(j.jsx)("h5",{children:e.pokemon.pokemonName})]})})},M=function(){var e=Object(c.useContext)(i).token,t=Object(O.b)(),n=Object(O.c)((function(e){return e.pokemons.caughtPokemons})),o=Object(O.c)((function(e){return e.load.loading})),r=Object(O.c)((function(e){return e.load.notAuth}));return Object(c.useEffect)((function(){t(function(e){return function(){var t=Object(f.a)(m.a.mark((function t(n){var c,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(P()),t.next=4,fetch("/api/img/caughtPokemons",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});case 4:return c=t.sent,t.next=7,c.json();case 7:o=t.sent,n({type:g,payload:o}),n(E()),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log("err",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(e))}),[t,e]),o?Object(j.jsx)(p,{}):r?Object(j.jsx)(I,{}):Object(j.jsx)("div",{className:"container__caught",children:n.map((function(e){return Object(j.jsx)(A,{pokemon:e},e.pokemonId)}))})},B=(n(54),function(e){var t=e.pokemon,n=t.date;return Object(j.jsx)("div",{className:"container__card",children:Object(j.jsxs)("div",{className:"card__pokemon",children:[Object(j.jsx)("div",{className:"card__img",children:Object(j.jsx)("img",{src:"/img/".concat(t.id,".png"),alt:"\u041f\u043e\u043a\u0435\u043c\u043e\u043d"})}),Object(j.jsxs)("div",{className:"card__info",children:[Object(j.jsx)("h3",{children:t.name}),Object(j.jsxs)("p",{children:["ID: ",t.id]}),n&&Object(j.jsxs)("p",{children:[" \u0414\u0430\u0442\u0430: ",t.date]}),n?Object(j.jsx)("p",{children:"\u0421\u0442\u0430\u0442\u0443\u0441: \u043f\u043e\u0439\u043c\u0430\u043d"}):Object(j.jsx)("p",{children:"\u0421\u0442\u0430\u0442\u0443\u0441: \u043d\u0435 \u043f\u043e\u0439\u043c\u0430\u043d"})]})]})})}),D=function(){var e=Object(s.h)().id,t=Object(c.useContext)(i).token,n=Object(O.b)(),o=Object(O.c)((function(e){return e.load.loading})),r=Object(O.c)((function(e){return e.pokemons.pokemon})),a=[];if(Object(c.useEffect)((function(){n(function(e,t){return function(){var n=Object(f.a)(m.a.mark((function n(c){var o,r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c(P()),n.next=4,fetch("/api/img/pokemon/".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});case 4:return o=n.sent,n.next=7,o.json();case 7:r=n.sent,c({type:k,payload:r}),c(E()),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("err",n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e){return n.apply(this,arguments)}}()}(e,t))}),[n,e,t]),o)return Object(j.jsx)(p,{});var u=r.id==e.split("").slice(1).join("");return u&&(a=r),Object(j.jsxs)("div",{children:[" ",!o&&u&&Object(j.jsx)(B,{pokemon:a})," "]})},G="user",L=(n(55),function(){var e=Object(s.g)(),t=Object(c.useContext)(i);return Object(j.jsx)("nav",{children:Object(j.jsx)("div",{className:"nav",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(l.b,{to:"/img",children:"pokemons"})}),Object(j.jsx)("li",{children:Object(j.jsx)(l.b,{to:"/caughtPokemons",children:"caughtPokemons"})}),Object(j.jsx)("li",{children:Object(j.jsx)("a",{href:"/",onClick:function(n){n.preventDefault(),t.logout(),e.push("/")},children:"logout"})})]})})})});var J=function(){var e=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)(null),a=Object(u.a)(r,2),s=a[0],i=a[1],l=Object(c.useState)(!1),j=Object(u.a)(l,2),b=j[0],d=j[1],p=Object(c.useCallback)((function(e,t){o(e),i(t),localStorage.setItem(G,JSON.stringify({userId:t,token:e}))}),[]),O=Object(c.useCallback)((function(){o(null),i(null),localStorage.removeItem(G)}),[]);return Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem(G));e&&e.token&&p(e.token,e.userId),d(!0)}),[p]),{login:p,logout:O,token:n,userId:s,ready:b}}(),t=e.token,n=e.login,o=e.logout,r=e.userId,a=e.ready,b=!!t,d=function(e){return e?Object(j.jsxs)(s.d,{children:[Object(j.jsx)(s.b,{path:"/pokemons",exact:!0,children:Object(j.jsx)(T,{})}),Object(j.jsx)(s.b,{path:"/caughtPokemons",children:Object(j.jsx)(M,{})}),Object(j.jsx)(s.b,{path:"/pokemon/:id",children:Object(j.jsx)(D,{})}),Object(j.jsx)(s.a,{to:"/pokemons"})]}):Object(j.jsxs)(s.d,{children:[Object(j.jsx)(s.b,{path:"/",exact:!0,children:Object(j.jsx)(I,{})}),Object(j.jsx)(s.a,{to:"/"})]})}(b);return a?Object(j.jsx)(i.Provider,{value:{token:t,login:n,logout:o,userId:r,isAuth:b},children:Object(j.jsxs)(l.a,{children:[b&&Object(j.jsx)(L,{}),d]})}):Object(j.jsx)(p,{})},F=n(14),z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,57)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),r(e),a(e)}))},H={pokemons:[],displayPokemons:[],caughtPokemons:[],page:1,isInit:!1,pokemon:{}},K={loading:!1,notAuth:!1,isMessage:!1},R=Object(F.b)({pokemons:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return e.pokemons.length||(e.isInit=!0),Object(S.a)(Object(S.a)({},e),{},{pokemons:t.payload,displayPokemons:e.pokemons.concat(t.payload).slice(0,6*e.page)});case v:return Object(S.a)(Object(S.a)({},e),{},{page:e.page+1,displayPokemons:e.pokemons.slice(0,6*(e.page+1))});case g:return Object(S.a)(Object(S.a)({},e),{},{caughtPokemons:t.payload});case k:return Object(S.a)(Object(S.a)({},e),{},{pokemon:t.payload});case C:return Object(S.a)(Object(S.a)({},e),{},{pokemon:{},caughtPokemons:[],pokemons:[]});default:return e}},load:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(S.a)(Object(S.a)({},e),{},{notAuth:!0});case y:return Object(S.a)(Object(S.a)({},e),{},{loading:!0});case N:return Object(S.a)(Object(S.a)({},e),{},{loading:!1});default:return e}}}),q=n(33),U=Object(F.d)(R,Object(F.c)(Object(F.a)(q.a)));a.a.render(Object(j.jsx)(O.a,{store:U,children:Object(j.jsx)(o.a.StrictMode,{children:Object(j.jsx)(J,{})})}),document.getElementById("root")),z()}},[[56,1,2]]]);
//# sourceMappingURL=main.8090c7e2.chunk.js.map